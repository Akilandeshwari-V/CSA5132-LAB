#include <stdio.h>
void sh(unsigned char*k,int n,unsigned char R){
unsigned char c=0;
for(int i=n-1;i>=0;i--){unsigned char t=k[i];k[i]=(t<<1)|c;c=t>>7;}
if(c)k[n-1]^=R;
}
int main(){
unsigned char L64[8]={0x12},L128[16]={0x12};
sh(L64,8,0x1B);sh(L64,8,0x1B);
sh(L128,16,0x87);sh(L128,16,0x87);
printf("K2-64=%02X\n",L64[0]);
printf("K2-128=%02X\n",L128[0]);
}
