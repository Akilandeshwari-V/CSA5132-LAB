#include <stdio.h>
#include <string.h>
void pad(unsigned char*p,int*l,int b){
p[(*l)++]=0x80;while(*l%b)p[(*l)++]=0;
}
void ecb(unsigned char*p,unsigned char*c,int n){
for(int i=0;i<n;i++)c[i]=p[i]^0xAA;
}
void cbc(unsigned char*p,unsigned char*c,int n){
unsigned char iv=0;
for(int i=0;i<n;i++){c[i]=p[i]^iv^0xAA;iv=c[i];}
}
void cfb(unsigned char*p,unsigned char*c,int n){
unsigned char iv=0;
for(int i=0;i<n;i++){unsigned char x=iv^0xAA;c[i]=p[i]^x;iv=c[i];}
}
int main(){
unsigned char p[64]="HELLOWORLD",c[64];int l=strlen(p),b=8;
pad(p,&l,b);
ecb(p,c,l);printf("ECB:");for(int i=0;i<l;i++)printf("%02X",c[i]);puts("");
cbc(p,c,l);printf("CBC:");for(int i=0;i<l;i++)printf("%02X",c[i]);puts("");
cfb(p,c,l);printf("CFB:");for(int i=0;i<l;i++)printf("%02X",c[i]);puts("");
}
